<!-- <ion-header>
  <ion-toolbar>
    <ion-title>home</ion-title>
  </ion-toolbar>
</ion-header> -->

<ion-content>

  <ion-buttons>
    <ion-menu-button>
      <ion-icon class="padding_menu" size="large" name="menu"></ion-icon>
    </ion-menu-button>
  </ion-buttons>

  <ion-list detail class="ion-listNotificacion" *ngIf="listOfertas.length > 0">
    <ion-list-header>
      Notificaciones
    </ion-list-header>

    <ion-item *ngFor="let item of listOfertas; let idx=index;">
      <ion-avatar slot="start">
        <img [src]="item.foto || './assets/perfil.png'">
      </ion-avatar>
      <ion-text *ngIf="item.ofrece" (click)="btnCliente(item)" color="dark">
        <ion-label>
          <p> Conductor {{ item['usuario']?.nombre | slice: 0: 20 }} </p>
          <p> Te LLevo ${{ ( item['ofrece'] || 0 ).toLocaleString(1) }} COP </p>
        </ion-label>
      </ion-text>
      <ion-button slot="end" fill="clear" color="danger" (click)="this.listOfertas.splice( idx, 1)">
        <ion-icon name="close-circle-outline"></ion-icon>
      </ion-button>
    </ion-item>
  </ion-list>

  <ion-button slot="fixed" id="btnRefres" fill="clear" color="dark" (click)="resetInit()" *ngIf="!disabledInfo">
    <ion-icon name="refresh-circle-outline"></ion-icon>
  </ion-button>

  <div class="mapa" id="mapa"></div>

  <ion-fab horizontal="end" vertical="bottom" slot="fixed" *ngIf="rolUser == 'usuario'">
    <ion-fab-button color="dark">
      <ion-icon md="caret-up" ios="chevron-up-circle-outline"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="top">
      <ion-fab-button color="light" (click)="solicitar('Particular')">
        <ion-icon name="car-sport-outline"></ion-icon>
      </ion-fab-button>
      <ion-fab-button color="light" (click)="solicitar('Carga')">
        <ion-icon name="bus-outline"></ion-icon>
      </ion-fab-button>
      <ion-fab-button color="light" (click)="solicitar('Domicilio')">
        <ion-icon name="fast-food-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab>
</ion-content>

<ion-footer *ngIf="disabled">
  <ion-toolbar class="ion-padding toolbarFooter" [ngClass]="{'toolbarFooterOpen': addresses.length > 0}">
    <ion-item lines="none">
      <ion-text color="dark" slot="start">
        <h5>Servicio {{ data.tipo }}</h5>
      </ion-text>
      <ion-button slot="end" id="btnRefres" fill="clear" color="dark" (click)=" ocultarMenu() ">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-item>
    <ion-input class="ion-color-lavel" [(ngModel)]="data.destino" placeholder="Destino" required type="text" (keyup)="getSearchDestinoMapbox($event)">
    </ion-input>
    <!-- <ion-searchbar debounce=500 (ionChange)="getSearchDestinoMapbox($event)" [value]="selectedAddress"></ion-searchbar> -->
    <ion-list lines="none" *ngIf="addresses.length > 0">
      <ion-item button *ngFor="let address of addresses" (click)="onSelect(address)">
        <ion-icon name="pin"></ion-icon>
        {{ address.place_name }}
      </ion-item>
    </ion-list>
    <ion-input class="ion-color-lavel" [(ngModel)]="data.ofreces" [disabled]="disabledConfirm" placeholder="Cuanto ofreces" required type="number">
    </ion-input>
    <ion-textarea [(ngModel)]="data.descripcion" placeholder="Descripcion" ></ion-textarea>
    <ion-button [disabled]="disableBtn" *ngIf="disabledOpt == 'orden'" color="primary" fill="clear" expand="full" (click)="btnOrdenar()" class="ion-padding ion-text-center">Ordenando Servicio</ion-button>
    <ion-button [disabled]="disableBtn" *ngIf="disabledOpt == 'cliente'" color="primary" fill="clear" expand="full" (click)="btnConfirn()" class="ion-padding ion-text-center">Confirmar Servicio</ion-button>
    <!-- <ion-button color="danger" fill="clear" expand="full" (click)="exitOrden()" class="ion-padding ion-text-center">Cerrar</ion-button> -->
  </ion-toolbar>
</ion-footer>

<ion-footer *ngIf="disabledOpt == 'ordenactiva'">
  <ion-toolbar class="ion-padding">
    <ion-label>
      <p>Destino {{ dataOrdenActiva.titulo }} Costo ${{ ( dataOrdenActiva.ofreceCliente || 0 ).toLocaleString(1) }} COP</p>
    </ion-label>
    <ion-button *ngIf="dataOrdenActiva.estado != 3" [disabled]="disableBtnOrdenCancelar" color="success" expand="full" (click)="CancelarServicio()" class="ion-padding ion-text-center">Cancelar servicio</ion-button>
  </ion-toolbar>
</ion-footer>