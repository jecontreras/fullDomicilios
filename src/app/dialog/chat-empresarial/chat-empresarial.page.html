<ion-header class="ionToolbarHeaderChat">
  <ion-toolbar class="ionToolbarHeaderChat">
    <ion-toolbar class="ionToolbarHeaderChat">
      <ion-button slot="start" fill="clear" (click)="exit()" color="light">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
      <div class="ion-text-center">
        <p>CHAT CON EL <span *ngIf="data.vista == 'driver'">DRIVER:</span> <span
            *ngIf="data.vista == 'cliente'">USUARIO:</span></p>
      </div>
    </ion-toolbar>
    <div class="ion-text-center">
      <p>
        <ion-chip class="chipPerfil ion-chipsHeader">
          <ion-avatar class="avatarPerfil">
            <img [src]="chatDe.foto || './assets/perfil.png'" />
          </ion-avatar>
          <ion-text color="light">
            <h5>{{ chatDe.nombre }} {{ chatDe.apellido }}</h5>
          </ion-text>
        </ion-chip>
      </p>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content>

    <div class="ion-text-center colorInfo">
      <ion-label>
        HORA: {{ data.ordenes.horaEntrega | date:'hh:mm:ss' }}
      </ion-label> <br>
      <ion-label>
        DIRECCIÃ“N: {{ data.ordenes.origentexto }}
      </ion-label> <br>
      <ion-label>
        NOMBRE: {{ data.ordenes.nombreCliente }}
      </ion-label> <br>
      <ion-label>
        MONTO A COBRAR: <input currencyMask [disabled]="true"  [(ngModel)]="data.ofreceCliente" [options]="{ align: 'left', prefix: 'USD$ ', thousands: '.', decimal: ',' }" />
      </ion-label>
    </div>


  <ion-card class="altoCars has-card-footer">
    <ion-card-header class="colorTitulo">
      <div class="ion-text-center">
        <ion-card-title class="textInf" color="medium">Estas hablando con el cliente</ion-card-title>
      </div>
    </ion-card-header>
  </ion-card>

  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)" pullMin="200" pullMax="300">
    <ion-refresher-content>
    </ion-refresher-content>
  </ion-refresher>

  <div>
    <ion-list>

      <ion-item *ngFor="let item of listRow">

        <ion-avatar slot="start" *ngIf="dataUser.id !== item.emisor.id">
          <img [src]="item['emisor']?.foto || './assets/perfil.png'">
        </ion-avatar>
        <ion-text color="dark" *ngIf="dataUser.id !== item.emisor.id">
          <h5>{{ item['text'] }}</h5>
        </ion-text>

        <ion-text color="dark" slot="end" *ngIf="dataUser.id === item.emisor.id">
          <h5>{{ item['text'] }}</h5>
        </ion-text>
        <ion-avatar slot="end" *ngIf="dataUser.id === item.emisor.id">
          <img [src]="item['emisor']?.foto || './assets/perfil.png'">
        </ion-avatar>

      </ion-item>
    </ion-list>
  </div>

  <div class="ion-text-center" *ngIf="listRow.length == 0">
    <ion-text colo="dark">
      <span>Lista Vacia</span>
    </ion-text>
  </div>

  <ion-infinite-scroll threshold="150px" (ionInfinite)="loadData( $event )">
    <ion-infinite-scroll-content loadingSpinner="crescent" loadingtext="Cargando data..">

    </ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>

<ion-footer>
  <ion-row>
    <ion-col size="12">
      <ion-item>
        <ion-input class="ion-color-lavel" [(ngModel)]="mensajeTxt" placeholder="Escribe un mensaje"
        (change)="submitChat()" [disabled]="data.ordenes.estado == 2" required type="text"></ion-input>
        <ion-button slot="end" fill="clear"(click)="submitChat()" [disabled]="data.ordenes.estado == 2">
          <ion-icon color="primary" name="arrow-forward-circle-outline"></ion-icon>
        </ion-button>
      </ion-item>
    </ion-col>
  </ion-row>
</ion-footer>